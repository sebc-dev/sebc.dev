---
phase: 02-home-page
plan: 02
type: execute
wave: 2
depends_on: ["02-01"]
files_modified:
  - src/components/article/FeaturedArticle.astro
  - src/components/article/ArticleCard.astro
  - src/components/article/CategoryFilter.astro
  - src/pages/en/index.astro
  - src/pages/fr/index.astro
autonomous: false

must_haves:
  truths:
    - "User sees a featured article prominently displayed at the top with image, metadata, and description"
    - "User can browse articles in a responsive grid (1 col mobile, 2 col tablet, 3 col desktop) with cards showing image, date, reading time, category, tags, and excerpt"
    - "User can filter articles by category using filter buttons that visually toggle active state and immediately update displayed articles"
    - "Featured article does NOT appear duplicated in the grid"
    - "Articles without images show a placeholder instead of broken image"
    - "Home page works correctly in both EN and FR with locale-appropriate dates and labels"
  artifacts:
    - path: "src/components/article/FeaturedArticle.astro"
      provides: "Full-width featured article hero with image, metadata, tags"
      min_lines: 30
    - path: "src/components/article/ArticleCard.astro"
      provides: "Article card for grid view with image, meta, title, excerpt, tags"
      min_lines: 30
    - path: "src/components/article/CategoryFilter.astro"
      provides: "Category filter button bar with All + dynamic categories"
      min_lines: 15
    - path: "src/pages/en/index.astro"
      provides: "English home page with featured article, filter bar, article grid"
      min_lines: 30
    - path: "src/pages/fr/index.astro"
      provides: "French home page with featured article, filter bar, article grid"
      min_lines: 30
  key_links:
    - from: "src/components/article/ArticleCard.astro"
      to: "src/lib/articles.ts"
      via: "imports Article type and getArticleUrl"
      pattern: "import.*getArticleUrl.*from.*@/lib/articles"
    - from: "src/components/article/FeaturedArticle.astro"
      to: "src/lib/articles.ts"
      via: "imports Article type and getArticleUrl"
      pattern: "import.*getArticleUrl.*from.*@/lib/articles"
    - from: "src/pages/en/index.astro"
      to: "src/lib/articles.ts"
      via: "calls getArticlesByLocale, getFeaturedArticle, getCategories"
      pattern: "getArticlesByLocale.*en"
    - from: "src/pages/en/index.astro"
      to: "src/components/article/FeaturedArticle.astro"
      via: "renders featured article component"
      pattern: "<FeaturedArticle"
    - from: "src/pages/en/index.astro"
      to: "src/components/article/ArticleCard.astro"
      via: "maps grid articles to card components"
      pattern: "gridArticles\\.map.*ArticleCard"
    - from: "CategoryFilter inline script"
      to: "ArticleCard data-category attribute"
      via: "vanilla JS querying data-filter and data-category"
      pattern: "querySelectorAll.*data-category"
---

<objective>
Build the visual components (FeaturedArticle, ArticleCard, CategoryFilter) and wire them into the EN and FR home pages with client-side category filtering.

Purpose: This plan delivers the three HOME requirements -- featured hero (HOME-01), article grid (HOME-02), and category filtering (HOME-03) -- completing the Phase 2 user experience.
Output: 3 article components, 2 updated home pages, working category filter with inline JS
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-home-page/02-RESEARCH.md
@.planning/phases/02-home-page/02-01-SUMMARY.md
@src/content.config.ts
@src/i18n/ui.ts
@src/i18n/utils.ts
@src/layouts/BaseLayout.astro
@src/lib/articles.ts
@src/utils/dates.ts
@src/components/ui/Tag.astro
@src/styles/global.css
@docs/design-research/home.html
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create FeaturedArticle, ArticleCard, and CategoryFilter components</name>
  <files>
    src/components/article/FeaturedArticle.astro
    src/components/article/ArticleCard.astro
    src/components/article/CategoryFilter.astro
  </files>
  <action>
    Create all three article display components. Reference the design mockup (docs/design-research/home.html) for exact Tailwind classes. Use Tailwind v4 class names throughout (rounded-xs for 2px corners, bg-linear-to-t for gradients).

    **FeaturedArticle.astro** (HOME-01):
    - Props: { article: Article }
    - Import Tag from "@/components/ui/Tag.astro", formatDate from "@/utils/dates", getArticleUrl and Article type from "@/lib/articles", getLangFromUrl and useTranslations from "@/i18n/utils"
    - Layout: section with py-12 md:py-16 border-b border-border fade-up
    - Inner: anchor tag wrapping md:grid md:grid-cols-[1.3fr_1fr] gap-10 items-center
    - Left side: image container with relative overflow-hidden rounded-xs border. Conditional render: if article.data.image exists, render <img> with aspect-[16/10] object-cover opacity-80 group-hover:opacity-100 transition-opacity (NO loading="lazy" -- above the fold). If no image, render placeholder div with >_ text. Gradient overlay: absolute inset-0 bg-linear-to-t from-canvas/50 to-transparent. Category badge: absolute top-4 left-4, use Tag component with variant="badge" or inline the badge classes.
    - Right side: metadata row (date + reading time with dot separator), h2 title (text-2xl md:text-3xl lg:text-4xl font-bold), description paragraph, tags row using Tag component with default variant.
    - Use tabular-nums class on time element (was article-number in mockup, but tabular-nums is the Tailwind utility).
    - Category badge on the image: render as inline span with text-xs font-code text-teal bg-canvas/80 backdrop-blur-sm px-2.5 py-1 rounded-xs border border-teal/20 (matches mockup exactly). Do NOT use the Tag component here -- the badge needs absolute positioning inside the image container.
    - Reading time label: use t("article.readingTime") from i18n.

    **ArticleCard.astro** (HOME-02):
    - Props: { article: Article; class?: string }
    - Same imports as FeaturedArticle
    - Root element: <article> with class:list={["group", className]} and data-category={article.data.category} attribute (critical for filtering)
    - Inner: anchor tag wrapping the card content
    - Image container: relative overflow-hidden rounded-xs border border-border group-hover:border-teal/30 transition-colors mb-4. Image with aspect-[16/10] object-cover opacity-75 group-hover:opacity-100 transition-opacity loading="lazy". Conditional image/placeholder (same pattern as FeaturedArticle but with loading="lazy"). Gradient overlay from-canvas/40. Category badge absolute top-3 left-3.
    - Metadata row: flex items-center gap-2 text-xs text-text-muted mb-2.5. Date (tabular-nums) + dot separator + reading time.
    - Title: h3 text-lg font-semibold leading-snug mb-2 group-hover:text-teal-bright transition-colors
    - Description: p text-text-secondary text-sm leading-relaxed line-clamp-2 mb-3. IMPORTANT: line-clamp-2 must be on a plain <p> tag with no other display utilities (see Research Pitfall 2).
    - Tags: flex flex-wrap gap-2, render article.data.tags using Tag component with default variant.

    **CategoryFilter.astro** (HOME-03):
    - Props: { categories: string[] }
    - Import getLangFromUrl and useTranslations from "@/i18n/utils"
    - Layout: section pt-10 pb-6 fade-up fade-up-d1
    - Inner: div flex items-center gap-3 overflow-x-auto pb-2 -mx-1 px-1
    - First button: "All" / "Tous" (using t("home.filterAll")), with data-filter="all" attribute. This button starts in active state: add classes text-teal-bright border-teal bg-teal-dim in addition to base classes.
    - Category buttons: iterate categories array. Each button has data-filter={category}, base classes: text-sm font-medium px-3.5 py-1.5 rounded-xs border border-border text-text-muted whitespace-nowrap transition-all hover:border-teal/40 hover:text-teal-bright.
    - Include inline <script> for category filtering logic:
      - Function initCategoryFilter() that:
        1. Queries all [data-filter] buttons and [data-category] article cards
        2. On button click: updates active state classes on ALL buttons (toggle text-teal-bright, border-teal, bg-teal-dim for active; text-text-muted, border-border for inactive)
        3. Shows/hides cards: if data-filter="all", remove hidden from all cards. Otherwise, add hidden to cards where data-category !== clicked category.
      - Wrap with: document.addEventListener("astro:page-load", initCategoryFilter) for View Transitions compatibility (per Research Pitfall 5 and established Phase 1 pattern).
    - The script must use TypeScript-compatible syntax (cast with `as HTMLElement` for dataset access).
  </action>
  <verify>
    Run `npx astro check` -- all 3 components pass type checking.
    Inspect each file: FeaturedArticle has md:grid-cols-[1.3fr_1fr], ArticleCard has data-category attribute, CategoryFilter has inline script with astro:page-load listener.
  </verify>
  <done>
    FeaturedArticle renders a 2-column hero layout with image, metadata, title, description, and tags. ArticleCard renders a card with data-category attribute, lazy-loaded image, metadata, and tags. CategoryFilter renders filter buttons with client-side JS that toggles card visibility. All match the design mockup Tailwind classes.
  </done>
</task>

<task type="auto">
  <name>Task 2: Wire components into EN and FR home pages</name>
  <files>
    src/pages/en/index.astro
    src/pages/fr/index.astro
  </files>
  <action>
    Replace the placeholder content in both home pages with the full article listing experience.

    **Both pages follow the same structure** (only the lang parameter differs):

    Frontmatter:
    - Import BaseLayout from "@/layouts/BaseLayout.astro"
    - Import FeaturedArticle from "@/components/article/FeaturedArticle.astro"
    - Import ArticleCard from "@/components/article/ArticleCard.astro"
    - Import CategoryFilter from "@/components/article/CategoryFilter.astro"
    - Import getArticlesByLocale, getFeaturedArticle, getCategories from "@/lib/articles"
    - Import getLangFromUrl, useTranslations from "@/i18n/utils"
    - Get lang from getLangFromUrl(Astro.url)
    - Get t from useTranslations(lang)
    - Fetch: const allArticles = await getArticlesByLocale(lang)
    - Fetch: const featured = await getFeaturedArticle(lang)
    - Fetch: const categories = await getCategories(lang)
    - Filter: const gridArticles = featured ? allArticles.filter(a => a.id !== featured.id) : allArticles (prevents duplication per Research Pitfall 4)

    Template:
    - Wrap in BaseLayout with title={t("nav.home")} and description={t("home.description")}
    - Container: div max-w-6xl mx-auto px-6 lg:px-8
    - Conditional featured: {featured && <FeaturedArticle article={featured} />}
    - Conditional filter: {categories.length > 0 && <CategoryFilter categories={categories} />}
    - Article grid section (pb-16): div grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6
    - Map gridArticles to ArticleCard components with stagger animation: class:list={["fade-up", i < 3 && `fade-up-d${Math.min(i + 1, 4)}`]}
    - Empty state: if gridArticles.length === 0 AND no featured, show section py-16 text-center with t("home.noArticles")

    **en/index.astro**: lang will resolve to "en" from URL /en/
    **fr/index.astro**: lang will resolve to "fr" from URL /fr/

    The pages should be nearly identical -- only the URL determines the locale. Do NOT hardcode lang strings.
  </action>
  <verify>
    Run `npx astro build` -- should complete with no errors.
    Run `npx astro dev` and visit http://localhost:4321/en/ -- should show featured article hero + 2 article cards in grid.
    Visit http://localhost:4321/fr/ -- should show French articles with French dates and labels.
    Click a category filter button -- articles should filter immediately. Click "All" / "Tous" -- all articles reappear.
    Resize browser to mobile (375px) -- grid should collapse to 1 column, featured should stack vertically.
  </verify>
  <done>
    EN home page at /en/ displays featured article hero, category filter bar, and article grid with 2 cards (3rd is featured, excluded from grid). FR home page at /fr/ displays equivalent French content. Category filtering works client-side. Responsive layout: 1 col mobile, 2 col tablet, 3 col desktop. Empty state message displays when no articles exist.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 3: Visual verification of home page</name>
  <what-built>Complete home page with featured article hero, category filter bar, responsive article card grid, and client-side filtering -- in both EN and FR.</what-built>
  <how-to-verify>
    1. Visit http://localhost:4321/en/ -- verify featured article displays with image, date ("Jan 15, 2026"), reading time ("8 min read"), title, description, and tags
    2. Scroll down -- verify 2 article cards in grid (TypeScript + CSS articles). Cards should have images (TypeScript) or placeholder (CSS -- no image). Check date formatting, reading time, line-clamped description
    3. Click "typescript" filter button -- only TypeScript card visible, button turns teal. Click "All" -- both cards return
    4. Visit http://localhost:4321/fr/ -- verify French content: dates in French format ("15 janv. 2026"), "min de lecture", "Tous" filter button
    5. Resize to mobile (375px) -- featured article stacks vertically (image above text), grid is 1 column
    6. Resize to tablet (~768px) -- grid is 2 columns
    7. Resize to desktop (~1280px) -- grid would be 3 columns (only 2 cards, so partial row is fine)
    8. Verify hover states: card borders turn teal-ish, titles turn teal-bright, images increase opacity
  </how-to-verify>
  <resume-signal>Type "approved" or describe specific issues to fix</resume-signal>
</task>

</tasks>

<verification>
1. `npx astro build` completes with zero errors
2. /en/ shows featured article hero with correct EN metadata
3. /fr/ shows featured article hero with correct FR metadata
4. Article grid displays cards with images, metadata, tags
5. Category filter buttons toggle visibility of cards
6. Responsive layout: 1/2/3 columns at mobile/tablet/desktop
7. Featured article excluded from grid (no duplication)
8. Articles without images show placeholder
9. Fade-up animations trigger on scroll
</verification>

<success_criteria>
- HOME-01: Featured article prominently displayed with image, metadata, description
- HOME-02: Responsive article grid with cards showing all required fields
- HOME-03: Category filter buttons toggle active state and filter articles
- Both EN and FR home pages work with correct locale formatting
- Design matches mockup (docs/design-research/home.html) Tailwind classes
</success_criteria>

<output>
After completion, create `.planning/phases/02-home-page/02-02-SUMMARY.md`
</output>
