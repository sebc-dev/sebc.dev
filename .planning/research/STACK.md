# Stack Research

**Domain:** Premium technical blog (additional libraries for existing Astro 5 + Cloudflare stack)
**Researched:** 2026-02-09
**Confidence:** HIGH

## Existing Stack (Already Installed -- DO NOT Re-add)

| Technology | Version | Purpose |
|------------|---------|---------|
| Astro | 5.17.1 | Core framework |
| @astrojs/cloudflare | 12.6.12 | Cloudflare Pages adapter |
| @astrojs/mdx | 4.3.13 | MDX content support |
| @astrojs/sitemap | 3.7.0 | XML sitemap generation |
| Tailwind CSS v4 | 4.1.18 | Styling (via @tailwindcss/vite) |
| Shiki | 3.22.0 | Syntax highlighting (bundled with Astro) |
| Pagefind | 1.4.0 | Client-side search indexing |
| TypeScript | 5.9.3 | Type safety |
| Vitest | ~3.2.4 | Unit testing |
| Playwright | 1.58.2 | E2E testing |
| ESLint 9 | 9.39.2 | Linting |

## Recommended Additional Stack

### SEO and Social Meta Tags

| Technology | Version | Purpose | Why Recommended |
|------------|---------|---------|-----------------|
| astro-seo | ^1.1.0 | SEO meta tags, Open Graph, Twitter Cards | Most mature Astro SEO component. v1.1.0 released Jan 2026. Peer dep on @astrojs/check ^0.9.0 (already installed). Provides title, description, canonical, OG, Twitter Cards, robots, language alternates, and arbitrary meta/link extensions via `extend` prop. Almost 1:1 mapping between props and HTML tags -- no magic, predictable output. |

**Confidence:** HIGH -- verified npm version (1.1.0), peer dep matches existing @astrojs/check ^0.9.6, recently published (Jan 2026).

### Reading Time

| Technology | Version | Purpose | Why Recommended |
|------------|---------|---------|-----------------|
| reading-time | ^1.5.0 | Calculate reading duration from text | Industry standard for "X min read" estimates. Used in official Astro recipe. No dependencies. |
| mdast-util-to-string | ^4.0.0 | Extract plain text from Markdown AST | Required by the remark-reading-time plugin to convert MDX tree to text for word counting. Part of the unified ecosystem (already used by Astro internally). |

**Implementation:** Custom remark plugin (`remark-reading-time.mjs`) as described in official Astro docs. The plugin injects `minutesRead` into frontmatter, accessible via `render()` in content collections.

**Confidence:** HIGH -- official Astro recipe at https://docs.astro.build/en/recipes/reading-time/

### Table of Contents

| Technology | Version | Purpose | Why Recommended |
|------------|---------|---------|-----------------|
| None needed | -- | TOC generation from headings | Astro's built-in `render()` function returns `headings` array with `{ depth, slug, text }` for every h1-h6. No library needed. Build TOC component from this data. |

**Implementation:** Use content collections `render()` which returns `{ Content, headings }`. The `headings` array is generated by Astro's built-in `collect-headings` plugin using `github-slugger`. Build a `<TableOfContents>` Astro component that takes `headings` as a prop and renders a nested list with anchor links.

**Confidence:** HIGH -- verified in official Astro docs. Astro automatically generates heading IDs and provides `getHeadings()` / `render().headings`.

### Heading Anchor Links

| Technology | Version | Purpose | Why Recommended |
|------------|---------|---------|-----------------|
| rehype-autolink-headings | ^7.1.0 | Add clickable anchor links to headings | Adds visible anchor links (e.g., a "#" icon) next to headings so users can copy section URLs. Works with Astro's built-in heading IDs -- no need for rehype-slug since Astro already generates IDs via `rehypeHeadingIds`. |

**Important:** Do NOT install `rehype-slug` -- Astro already generates heading IDs via its built-in `rehypeHeadingIds` plugin. Adding rehype-slug would duplicate work. Only `rehype-autolink-headings` is needed, configured with `behavior: 'append'` to add a link after each heading.

**Confidence:** HIGH -- verified via Astro docs and npm (v7.1.0).

### Code Block Copy Button

| Technology | Version | Purpose | Why Recommended |
|------------|---------|---------|-----------------|
| astro-expressive-code | ^0.41.6 | Enhanced code blocks with copy button, language labels, line numbers | Replaces Astro's default Shiki config for MDX code blocks. Provides copy-to-clipboard button out of the box (no custom JS needed), language labels, line highlighting, word wrap, diff notation, and frame styles. Peer dep supports Astro 3-6. Actively maintained, used by Astro Starlight. |

**Alternative considered:** `@shikijs/transformers` -- provides `transformerCopyButton()` and other transformers, but requires writing all CSS yourself and wiring up clipboard JS. Expressive Code is batteries-included and purpose-built for Astro.

**Confidence:** HIGH -- npm version verified (0.41.6), peer deps confirmed (`astro: ^3.3.0 || ^4.0.0-beta || ^5.0.0-beta || ^6.0.0-beta`).

### Custom Pagefind Search UI

| Technology | Version | Purpose | Why Recommended |
|------------|---------|---------|-----------------|
| Pagefind JS API | (bundled) | Custom search UI using Pagefind's JavaScript API | Already installed (pagefind 1.4.0). Use the JS API (`/pagefind/pagefind.js`) directly instead of the default widget. Provides `pagefind.search()`, `pagefind.debouncedSearch()`, `pagefind.filters()`, and lazy-loaded result data. Build a custom Astro component styled with Tailwind that matches the "Minimal Depth" design. |

**No additional package needed.** Pagefind generates its JS API at build time in the output directory. Import it dynamically in a `<script>` tag within an Astro component.

**Confidence:** HIGH -- verified at https://pagefind.app/docs/api/

### Share Buttons

| Technology | Version | Purpose | Why Recommended |
|------------|---------|---------|-----------------|
| None (custom component) | -- | Share to Twitter/X, LinkedIn, dev.to, copy link | Share buttons are simple URL constructions with zero dependencies. Twitter: `https://twitter.com/intent/tweet?url=...&text=...`. LinkedIn: `https://www.linkedin.com/sharing/share-offsite/?url=...`. dev.to: link to "new post" prefilled. Copy link: `navigator.clipboard.writeText()`. No library needed -- a 30-line Astro component handles this better than any package. |

**Why NOT astro-social-share (v2.2.0):** Last updated April 2025. Adds unnecessary dependency for what is literally URL string concatenation. The package has no peer deps, meaning it bundles its own icons -- better to use your own SVG icons that match your design system. Custom component gives full control over styling, supported platforms, and i18n of button labels.

**Confidence:** HIGH -- share URL patterns are stable, well-documented platform APIs.

### Reading Progress Bar

| Technology | Version | Purpose | Why Recommended |
|------------|---------|---------|-----------------|
| None (custom component) | -- | Scroll progress indicator at top of article pages | Pure CSS + ~10 lines of JS using `scroll` event or CSS `animation-timeline: scroll()`. No library needed. For broadest compatibility, use JS: `window.scrollY / (document.documentElement.scrollHeight - window.innerHeight)` to calculate progress percentage, update a CSS custom property on a fixed-position `<div>`. |

**Confidence:** HIGH -- standard browser API, trivial implementation.

### Scroll-Reveal Animations

| Technology | Version | Purpose | Why Recommended |
|------------|---------|---------|-----------------|
| None (custom directive) | -- | IntersectionObserver-based reveal animations | Write a small Astro client-side script (~25 lines) using `IntersectionObserver` API. Add `data-reveal` attributes to elements, observe them, toggle a CSS class (e.g., `.revealed`) that triggers Tailwind CSS transitions. Zero-dependency, works everywhere, full control over thresholds and animation style. |

**Why NOT AOS/sal.js/Motion:** AOS (2.3.4) is 5.7KB + 23.3KB CSS -- massive overkill for "fade in on scroll." sal.js (0.8.5) is lighter but still a dependency for trivial functionality. Motion (12.33.0) is 33KB+ and designed for complex animations. For a content blog with subtle reveals, the native IntersectionObserver API is the right tool.

**Confidence:** HIGH -- IntersectionObserver is supported in all modern browsers.

### Cloudflare Analytics

| Technology | Version | Purpose | Why Recommended |
|------------|---------|---------|-----------------|
| None (automatic injection) | -- | Privacy-respecting analytics | Cloudflare Pages auto-injects the Web Analytics beacon (`beacon.min.js`) when enabled in the dashboard. No npm package needed. Steps: Dashboard > Workers & Pages > [project] > Metrics > Enable. The script is injected at the edge into all HTML responses on next deployment. Requires valid HTML structure (DOCTYPE, html, head, body tags). |

**Fallback:** If auto-injection fails (e.g., for non-proxied domains), manually add `<script defer src='https://static.cloudflareinsights.com/beacon.min.js' data-cf-beacon='{"token": "YOUR_TOKEN"}'></script>` before `</body>` in your base layout.

**Confidence:** HIGH -- verified at https://developers.cloudflare.com/pages/how-to/web-analytics/

### i18n Utilities

| Technology | Version | Purpose | Why Recommended |
|------------|---------|---------|-----------------|
| None (Astro built-in) | -- | i18n routing, locale URL generation, locale detection | Astro 5 ships comprehensive i18n utilities in `astro:i18n` module. Already configured in `astro.config.mjs` with `i18n: { defaultLocale: 'en', locales: ['en', 'fr'] }`. |

**Built-in functions from `astro:i18n`:**
- `getRelativeLocaleUrl(locale, path)` -- generate locale-prefixed URLs
- `getAbsoluteLocaleUrl(locale, path)` -- full URLs with domain
- `getRelativeLocaleUrlList(path)` -- URLs for all locales (useful for language switcher)
- `getLocaleByPath(path)` -- detect locale from URL
- `getPathByLocale(locale)` -- get path for a locale code
- `Astro.currentLocale` -- current page locale in `.astro` files
- `Astro.preferredLocale` / `Astro.preferredLocaleList` -- browser language detection

**For translated content strings:** Use a simple JSON/TS dictionary pattern (`src/i18n/ui.ts` with `{ en: { ... }, fr: { ... } }`) and a `useTranslation(locale)` helper. No third-party i18n library needed for a bilingual blog.

**Why NOT paraglide/astro-i18n-aut:** Paraglide is designed for apps with dozens of languages and complex message formatting (ICU). Overkill for a 2-language blog. astro-i18n-aut is largely superseded by Astro's built-in i18n (added in v4.0). Neither adds value over the built-in solution for this use case.

**Confidence:** HIGH -- verified at https://docs.astro.build/en/reference/modules/astro-i18n/

## Installation

```bash
# Additional production dependencies
npm install astro-seo reading-time mdast-util-to-string

# Additional dev dependencies (integrations)
npm install -D astro-expressive-code rehype-autolink-headings
```

**Total: 3 production deps + 2 dev deps.** Everything else is either built into Astro, built into Pagefind, built into Cloudflare Pages, or trivially implemented as a custom component.

## Alternatives Considered

| Recommended | Alternative | When to Use Alternative |
|-------------|-------------|-------------------------|
| astro-seo | astro-seo-meta (5.2.0) | If you want explicit Astro 5 peer dep declaration (though astro-seo 1.1.0 works fine with Astro 5 via @astrojs/check) |
| astro-seo | Manual `<meta>` tags | If you only have 2-3 pages and want zero deps. Not worth it once you have articles with dynamic OG tags |
| astro-expressive-code | @shikijs/transformers (3.22.0) | If you want maximum control over code block styling and are willing to write all CSS + clipboard JS yourself |
| astro-expressive-code | rehype-pretty-code | If you need transformers from `@rehype-pretty/transformers`. But expressive-code covers all common needs |
| Custom IntersectionObserver | AOS (2.3.4) | If you want 20+ predefined animation types without writing CSS. Adds ~29KB |
| Custom share component | astro-social-share (2.2.0) | Never -- adds dependency for URL concatenation |
| Built-in Astro i18n | Paraglide JS 2.x | If you scale to 5+ languages with complex pluralization rules |
| Built-in Astro i18n | astro-i18n-aut | Never -- superseded by Astro built-in i18n since v4.0 |

## What NOT to Use

| Avoid | Why | Use Instead |
|-------|-----|-------------|
| rehype-slug | Astro already generates heading IDs via built-in `rehypeHeadingIds`. Adding rehype-slug duplicates work and can conflict. | Astro's built-in heading ID generation |
| remark-toc | Injects a TOC into the markdown body itself. You want a separate TOC component in the sidebar, not inline. | Custom `<TableOfContents>` component using `render().headings` |
| @astrojs/tailwind | Deprecated since Astro 5.2. Already using `@tailwindcss/vite` correctly. | @tailwindcss/vite (already installed) |
| astro-i18n-aut | Superseded by Astro's built-in i18n routing (since v4.0). Cannot do translated URL slugs anyway. | `astro:i18n` module |
| Any heavy animation library (GSAP, Framer Motion, Motion) | Massive JS payload for a static content blog. Scroll reveals should be CSS transitions triggered by IntersectionObserver. | Custom ~25-line IntersectionObserver script |
| Google Analytics | Privacy concern for a dev blog audience. Cloudflare Web Analytics is free, privacy-respecting, and auto-injected. | Cloudflare Web Analytics (auto-injected) |
| next-seo / react-helmet | React-based SEO solutions. Not compatible with Astro's component model. | astro-seo |

## Version Compatibility

| Package | Compatible With | Notes |
|---------|-----------------|-------|
| astro-seo@1.1.0 | @astrojs/check ^0.9.0 (installed: ^0.9.6) | Only peer dep. Works with Astro 5 |
| astro-expressive-code@0.41.6 | astro ^3.3.0 to ^6.0.0-beta | Broad compatibility. Will survive Astro 6 upgrade |
| rehype-autolink-headings@7.1.0 | unified ^11.0.0 (bundled with Astro) | Part of rehype ecosystem, compatible with Astro's Markdown pipeline |
| reading-time@1.5.0 | No peer deps | Pure utility, framework-agnostic |
| mdast-util-to-string@4.0.0 | Part of unified/mdast ecosystem | Already used internally by Astro's markdown processing |
| Pagefind JS API | pagefind@1.4.0 (installed) | API is generated at build time, no separate install needed |

## Astro 6 Migration Note

Astro 6 Beta was announced in Feb 2026 (Cloudflare acquisition). Key breaking changes:
- Requires Node 22+ (verify current Node version)
- Removes `Astro.glob()` and legacy content collections
- Upgrades Zod to v4
- Modified i18n default behavior

**Impact on this stack:** All recommended packages (astro-seo, astro-expressive-code) already declare Astro 6 beta compatibility in their peer deps. The custom components (TOC, share, progress bar, scroll-reveal) use standard browser APIs and will not be affected. Staying on Astro 5 for now is correct -- upgrade to 6 when stable release ships.

## Sources

- Astro Markdown docs (headings, TOC) -- https://docs.astro.build/en/guides/markdown-content/ [HIGH confidence]
- Astro Reading Time recipe -- https://docs.astro.build/en/recipes/reading-time/ [HIGH confidence]
- Astro i18n Routing -- https://docs.astro.build/en/guides/internationalization/ [HIGH confidence]
- Astro i18n API Reference -- https://docs.astro.build/en/reference/modules/astro-i18n/ [HIGH confidence]
- Astro Syntax Highlighting -- https://docs.astro.build/en/guides/syntax-highlighting/ [HIGH confidence]
- Pagefind JS API -- https://pagefind.app/docs/api/ [HIGH confidence]
- Cloudflare Pages Web Analytics -- https://developers.cloudflare.com/pages/how-to/web-analytics/ [HIGH confidence]
- astro-seo GitHub -- https://github.com/jonasmerlin/astro-seo [HIGH confidence]
- npm version checks -- verified via `npm view` on 2026-02-09 [HIGH confidence]
- Astro 6 Beta announcement -- https://astro.build/blog/astro-6-beta/ [HIGH confidence]

---
*Stack research for: sebc.dev premium technical blog (additional libraries)*
*Researched: 2026-02-09*
