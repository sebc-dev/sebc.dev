<div
  id="reading-progress"
  class="fixed top-0 left-0 z-[60] h-0.5 w-full bg-teal"
  style="transform: scaleX(0)"
>
</div>

<script>
  document.addEventListener("astro:page-load", () => {
    const bar = document.getElementById("reading-progress");
    const article = document.querySelector("article");
    if (!bar || !article) return;

    function updateProgress() {
      if (!bar || !article) return;
      const rect = article.getBoundingClientRect();
      const articleTop = rect.top + window.scrollY;
      const articleHeight = rect.height;
      const scrolled = window.scrollY - articleTop;
      const progress = Math.min(
        Math.max(scrolled / (articleHeight - window.innerHeight), 0),
        1,
      );
      bar.style.transform = `scaleX(${progress})`;
    }

    window.addEventListener("scroll", updateProgress, { passive: true });
    updateProgress();
  });
</script>
